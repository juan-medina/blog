<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Python Unit Tests | Juan Medina Personal Blog</title>
  <meta name="author" content="Juan Medina">
  <meta name="description" content="Personal blog from Juan Medina">
  <meta property="og:title" content="Python Unit Tests | Juan Medina Personal Blog">
  <meta property="og:url" content="http://juan-medina.com/2017/02/22/python-unit-tests/">
  <meta property="og:site_name" content="Juan Medina Personal Blog">
  <meta property="og:description" content="Personal blog from Juan Medina">
  <meta property="og:image" content="http://juan-medina.com/assets/img/tdd.jpg">
  <meta property="og:type" content="blog">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:description" content="Personal blog from Juan Medina">
  <meta name="twitter:title" content="Python Unit Tests | Juan Medina Personal Blog">
  <meta name="twitter:url" content="http://juan-medina.com/2017/02/22/python-unit-tests/">
  <meta name="twitter:site" content="Juan Medina Personal Blog">
  <meta name="twitter:creator" content="@JuanMedinaCode">
  <meta name="twitter:domain" content="http://juan-medina.com">
  <meta property="twitter:image" content="http://juan-medina.com/assets/img/tdd.jpg">

  <link type="application/atom+xml" rel="alternate" href="http://juan-medina.com/feed.xml" title="Juan Medina Personal Blog" />

  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inconsolata|Lora|Space+Mono:700">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css">
  <link rel="stylesheet" href="/assets/css/main.css">
  <link rel="stylesheet" href="/assets/css/syntax.css">

  <link rel="alternate" type="application/rss+xml" title="Juan Medina Personal Blog" href="http://juan-medina.com/feed.xml">
  <link rel="canonical" href="http://juan-medina.com/2017/02/22/python-unit-tests/">

  
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-71726617-1', 'auto');
      ga('send', 'pageview');
    </script>
  
</head>


  <body>

    <main>
      <article itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="section-padding--lg mast rellax" data-rellax-speed="-4">
    <a class="nav nav--white" href="/">
      <i class="fa fa-lg fa-arrow-left"></i>
      <span>Back to Posts</span>
    </a>
    <figure class="absolute-bg mast__img" style="background-image: url('/assets/img/tdd.jpg');"></figure>
    <div class="mast__container">
      <span><time datetime="2017-02-22T23:41:11+00:00" itemprop="datePublished">Feb 22, 2017</time></span>
      <h1 itemprop="name headline">Python Unit Tests</h1>
      
        <span>Posted in
          
            <a class="nav--white" href="/category/programming">Programming</a>
          
        </span>
      
      <span></span>
    </div>
  </header>

  <section class="section-padding bg-grey" itemprop="articleBody">
    <div class="post">
      <p>I’ve an strong believe that programming in different languages is something that all developers should do, and do it so you face different problems and apply different technics to solve them.</p>

<p>Python is great for a lot of tasks, and I’m using it for tooling a lot, but I’m not doing much Unit Testing on it so I decide to improve and expand my tests.</p>

<p>So here is what I learn so far, if you want to skip these and go directly to the code <a href="https://github.com/LearningByExample/PythonUnitTests" target="_blank">here is the git repo</a> with every example bellow.</p>

<p>I’ve decide to use <a href="http://nose.readthedocs.io/en/latest/" target="_blank">nose</a> as test runner, and <a href="https://pypi.python.org/pypi/PyHamcrest" target="_blank">PyHamcrest</a>  as the assertion framework, specially since I familiar with the popular <a href="https://code.google.com/archive/p/hamcrest/wikis/Tutorial.wiki" target="_blank">Java equivalent</a>.</p>

<p>So lest start with the first example, testing this small class saved in a file named: <em>calc.py</em></p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">class</span> <span class="nc">Calc</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">sum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">a</span><span class="o">+</span><span class="n">b</span>

    <span class="k">def</span> <span class="nf">sub</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">a</span><span class="o">-</span><span class="n">b</span></code></pre></figure>

<p>And here our first test in a file named: <em>test_calc.py</em></p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">unittest</span> <span class="kn">import</span> <span class="n">TestCase</span>
<span class="kn">from</span> <span class="nn">hamcrest</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">calc</span> <span class="kn">import</span> <span class="n">Calc</span>


<span class="k">class</span> <span class="nc">TestCal</span><span class="p">(</span><span class="n">TestCase</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">test_sum</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">calculator</span> <span class="o">=</span> <span class="n">Calc</span><span class="p">()</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">calculator</span><span class="o">.</span><span class="nb">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">assert_that</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">is_</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">test_sub</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">calculator</span> <span class="o">=</span> <span class="n">Calc</span><span class="p">()</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">calculator</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">assert_that</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">is_</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span></code></pre></figure>

<p>To run the test just this in the same directory that both files are place:</p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">~/ <span class="nv">$ </span>python <span class="nt">-m</span> nose</code></pre></figure>

<p>The first test is really simple and just we call our class methods and check in hamcrest style that result is what we expect.</p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">..
<span class="nt">----------------------------------------------------------------------</span>
Ran 2 tests <span class="k">in </span>0.020s

OK</code></pre></figure>

<p>Let’s make our class a bit more interesting adding a method that give the last result</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">class</span> <span class="nc">Calc</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="n">_last_result</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="k">def</span> <span class="nf">operation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">result</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_last_result</span> <span class="o">=</span> <span class="n">result</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_last_result</span>

    <span class="k">def</span> <span class="nf">sum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">operation</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">sub</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">operation</span><span class="p">(</span><span class="n">a</span> <span class="o">-</span> <span class="n">b</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">result</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_last_result</span></code></pre></figure>

<p>With the new test we could add some more bits, like concatenating expressions</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">unittest</span> <span class="kn">import</span> <span class="n">TestCase</span>
<span class="kn">from</span> <span class="nn">hamcrest</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">calc</span> <span class="kn">import</span> <span class="n">Calc</span>


<span class="k">class</span> <span class="nc">TestCal</span><span class="p">(</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">test_sum</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">calculator</span> <span class="o">=</span> <span class="n">Calc</span><span class="p">()</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">calculator</span><span class="o">.</span><span class="nb">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">assert_that</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">is_</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">test_sub</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">calculator</span> <span class="o">=</span> <span class="n">Calc</span><span class="p">()</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">calculator</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">assert_that</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">is_</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">test_result</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">calc</span> <span class="o">=</span> <span class="n">Calc</span><span class="p">()</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">calc</span><span class="o">.</span><span class="nb">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">assert_that</span><span class="p">(</span><span class="n">calc</span><span class="o">.</span><span class="n">result</span><span class="p">(),</span> <span class="n">is_</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">is_</span><span class="p">(</span><span class="n">result</span><span class="p">))</span></code></pre></figure>

<p>Now to go really crazy lets make our class to been able to repeat operation using some lambdas:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">class</span> <span class="nc">Calc</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="n">_last_result</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">_last_operation</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">_sum</span> <span class="o">=</span> <span class="k">lambda</span> <span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span>
    <span class="n">_sub</span> <span class="o">=</span> <span class="k">lambda</span> <span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="n">a</span> <span class="o">-</span> <span class="n">b</span>

    <span class="k">def</span> <span class="nf">operation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">function</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_last_result</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_last_operation</span> <span class="o">=</span> <span class="n">function</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_last_result</span>

    <span class="k">def</span> <span class="nf">sum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">operation</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_sum</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">sub</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">operation</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_sub</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">result</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_last_result</span>

    <span class="k">def</span> <span class="nf">repeat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">operation</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_last_operation</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span></code></pre></figure>

<p>Now for test we could test that this new method work, even creating a new lambda for it:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">om</span> <span class="n">unittest</span> <span class="kn">import</span> <span class="nn">TestCase</span>
<span class="kn">from</span> <span class="nn">hamcrest</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">types</span> <span class="kn">import</span> <span class="o">*</span>

<span class="kn">from</span> <span class="nn">calc</span> <span class="kn">import</span> <span class="n">Calc</span>


<span class="k">class</span> <span class="nc">TestCal</span><span class="p">(</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">test_sum</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">calculator</span> <span class="o">=</span> <span class="n">Calc</span><span class="p">()</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">calculator</span><span class="o">.</span><span class="nb">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">assert_that</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">is_</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">test_sub</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">calculator</span> <span class="o">=</span> <span class="n">Calc</span><span class="p">()</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">calculator</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">assert_that</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">is_</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">test_result</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">calc</span> <span class="o">=</span> <span class="n">Calc</span><span class="p">()</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">calc</span><span class="o">.</span><span class="nb">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">assert_that</span><span class="p">(</span><span class="n">calc</span><span class="o">.</span><span class="n">result</span><span class="p">(),</span> <span class="n">is_</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">is_</span><span class="p">(</span><span class="n">result</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">test_operation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">calc</span> <span class="o">=</span> <span class="n">Calc</span><span class="p">()</span>

        <span class="n">mult</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="n">a</span> <span class="o">*</span> <span class="n">b</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">calc</span><span class="o">.</span><span class="n">operation</span><span class="p">(</span><span class="n">mult</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>

        <span class="n">assert_that</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">is_</span><span class="p">(</span><span class="mi">25</span><span class="p">))</span>
        <span class="n">assert_that</span><span class="p">(</span><span class="n">calc</span><span class="o">.</span><span class="n">_last_operation</span><span class="p">,</span> <span class="n">is_</span><span class="p">(</span><span class="n">mult</span><span class="p">),</span> <span class="n">is_</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">LambdaType</span><span class="p">)))</span>

    <span class="k">def</span> <span class="nf">test_repeat</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">calc</span> <span class="o">=</span> <span class="n">Calc</span><span class="p">()</span>

        <span class="n">result</span> <span class="o">=</span> <span class="n">calc</span><span class="o">.</span><span class="nb">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">assert_that</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">is_</span><span class="p">(</span><span class="n">calc</span><span class="o">.</span><span class="n">result</span><span class="p">()))</span>

        <span class="n">result</span> <span class="o">=</span> <span class="n">calc</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">assert_that</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">is_</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span></code></pre></figure>

<p>Now for modification of our class lets create some validation of parameters raising exceptions</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">types</span> <span class="kn">import</span> <span class="o">*</span>


<span class="k">class</span> <span class="nc">Calc</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="n">_last_result</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">_last_operation</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">_sum</span> <span class="o">=</span> <span class="k">lambda</span> <span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span>
    <span class="n">_sub</span> <span class="o">=</span> <span class="k">lambda</span> <span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="n">a</span> <span class="o">-</span> <span class="n">b</span>

    <span class="k">def</span> <span class="nf">operation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">function</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="ow">is</span> <span class="n">IntType</span><span class="p">):</span>
            <span class="k">raise</span> <span class="nb">TypeError</span><span class="p">(</span><span class="s">"a is not a number"</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="ow">is</span> <span class="n">IntType</span><span class="p">):</span>
            <span class="k">raise</span> <span class="nb">TypeError</span><span class="p">(</span><span class="s">"b is not a number"</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">((</span><span class="nb">type</span><span class="p">(</span><span class="n">function</span><span class="p">)</span> <span class="ow">is</span> <span class="n">MethodType</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">function</span><span class="p">)</span> <span class="ow">is</span> <span class="n">FunctionType</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="nb">TypeError</span><span class="p">(</span><span class="s">"function is not a function"</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_last_result</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_last_operation</span> <span class="o">=</span> <span class="n">function</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_last_result</span>

    <span class="k">def</span> <span class="nf">sum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">operation</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_sum</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">sub</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">operation</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_sub</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">result</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_last_result</span>

    <span class="k">def</span> <span class="nf">repeat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">operation</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_last_operation</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span></code></pre></figure>

<p>and in our test will add checking that the exceptions are raise when they should:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">unittest</span> <span class="kn">import</span> <span class="n">TestCase</span>
<span class="kn">from</span> <span class="nn">hamcrest</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">types</span> <span class="kn">import</span> <span class="o">*</span>

<span class="kn">from</span> <span class="nn">calc</span> <span class="kn">import</span> <span class="n">Calc</span>


<span class="k">class</span> <span class="nc">TestCal</span><span class="p">(</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">test_sum</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">calculator</span> <span class="o">=</span> <span class="n">Calc</span><span class="p">()</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">calculator</span><span class="o">.</span><span class="nb">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">assert_that</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">is_</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">test_sub</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">calculator</span> <span class="o">=</span> <span class="n">Calc</span><span class="p">()</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">calculator</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">assert_that</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">is_</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">test_result</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">calc</span> <span class="o">=</span> <span class="n">Calc</span><span class="p">()</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">calc</span><span class="o">.</span><span class="nb">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">assert_that</span><span class="p">(</span><span class="n">calc</span><span class="o">.</span><span class="n">result</span><span class="p">(),</span> <span class="n">is_</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">is_</span><span class="p">(</span><span class="n">result</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">test_operation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">calc</span> <span class="o">=</span> <span class="n">Calc</span><span class="p">()</span>

        <span class="n">mult</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="n">a</span> <span class="o">*</span> <span class="n">b</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">calc</span><span class="o">.</span><span class="n">operation</span><span class="p">(</span><span class="n">mult</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>

        <span class="n">assert_that</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">is_</span><span class="p">(</span><span class="mi">25</span><span class="p">))</span>
        <span class="n">assert_that</span><span class="p">(</span><span class="n">calc</span><span class="o">.</span><span class="n">_last_operation</span><span class="p">,</span> <span class="n">is_</span><span class="p">(</span><span class="n">mult</span><span class="p">),</span> <span class="n">is_</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">LambdaType</span><span class="p">)))</span>

    <span class="k">def</span> <span class="nf">test_repeat</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">calc</span> <span class="o">=</span> <span class="n">Calc</span><span class="p">()</span>

        <span class="n">result</span> <span class="o">=</span> <span class="n">calc</span><span class="o">.</span><span class="nb">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">assert_that</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">is_</span><span class="p">(</span><span class="n">calc</span><span class="o">.</span><span class="n">result</span><span class="p">()))</span>

        <span class="n">result</span> <span class="o">=</span> <span class="n">calc</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">assert_that</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">is_</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">test_operations_with_invalid_function</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">calc</span> <span class="o">=</span> <span class="n">Calc</span><span class="p">()</span>

        <span class="n">assert_that</span><span class="p">(</span><span class="n">calling</span><span class="p">(</span><span class="n">calc</span><span class="o">.</span><span class="n">operation</span><span class="p">)</span><span class="o">.</span><span class="n">with_args</span><span class="p">(</span><span class="s">"function"</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
                    <span class="n">raises</span><span class="p">(</span><span class="nb">TypeError</span><span class="p">,</span> <span class="s">"function is not a function"</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">test_with_invalid_a_or_b</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">calc</span> <span class="o">=</span> <span class="n">Calc</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">function</span> <span class="ow">in</span> <span class="n">calc</span><span class="o">.</span><span class="nb">sum</span><span class="p">,</span> <span class="n">calc</span><span class="o">.</span><span class="n">sub</span><span class="p">:</span>
            <span class="n">assert_that</span><span class="p">(</span><span class="n">calling</span><span class="p">(</span><span class="n">function</span><span class="p">)</span><span class="o">.</span><span class="n">with_args</span><span class="p">(</span><span class="s">"a"</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
                        <span class="n">raises</span><span class="p">(</span><span class="nb">TypeError</span><span class="p">,</span> <span class="s">"a is not a number"</span><span class="p">))</span>
            <span class="n">assert_that</span><span class="p">(</span><span class="n">calling</span><span class="p">(</span><span class="n">function</span><span class="p">)</span><span class="o">.</span><span class="n">with_args</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s">"b"</span><span class="p">),</span>
                        <span class="n">raises</span><span class="p">(</span><span class="nb">TypeError</span><span class="p">,</span> <span class="s">"b is not a number"</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">test_with_no_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">calc</span> <span class="o">=</span> <span class="n">Calc</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">function</span> <span class="ow">in</span> <span class="n">calc</span><span class="o">.</span><span class="nb">sum</span><span class="p">,</span> <span class="n">calc</span><span class="o">.</span><span class="n">sub</span><span class="p">,</span> <span class="n">calc</span><span class="o">.</span><span class="n">operation</span><span class="p">:</span>
            <span class="n">assert_that</span><span class="p">(</span><span class="n">calling</span><span class="p">(</span><span class="n">function</span><span class="p">)</span><span class="o">.</span><span class="n">with_args</span><span class="p">(),</span> <span class="n">raises</span><span class="p">(</span><span class="nb">TypeError</span><span class="p">))</span></code></pre></figure>

<p>I think this if enough for today, next day maybe a different language.</p>

    

    <div id="disqus_thread"></div>
    <script>

    /**
    *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
    *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/

    var disqus_config = function () {
    this.page.url = "https://juan-medina.com/2017/02/22/python-unit-tests/";
    this.page.identifier = "/2017/02/22/python-unit-tests/"; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
    this.page.title = "Python Unit Tests";
    };

    (function() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    s.src = '//juan-medina-com.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
    })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

    

    </div>
  </section>

  <section class="profile">
    <div class="profile__card">
      <div class="profile__img">
        <figure class="absolute-bg" style="background-image: url('/assets/img/pp.jpg');"></figure>
      </div>
      <div class="profile__container">
        <p><b>About Juan Medina</b><br/> I'm just a normal geek that code all kind of stuff, from complex corporate applications to games.<br/> <br/> Games, music, movies and traveling are my escape pods.</p>
        
          <ul class="profile__social">
            
              <li><a class="fa fa-lg fa-envelope-o" href="mailto:mail@juan-medina.com"></a></li>
            
            
              <li><a class="fa fa-lg fa-address-card" href="https://juan-medina.com/cv" target="_blank"></a></li>
            
              <li><a class="fa fa-lg fa-github" href="https://github.com/juan-medina" target="_blank"></a></li>
            
              <li><a class="fa fa-lg fa-twitter" href="https://twitter.com/JuanMedinaCode" target="_blank"></a></li>
            
              <li><a class="fa fa-lg fa-stack-overflow" href="http://stackoverflow.com/users/7910403/juan-medina" target="_blank"></a></li>
            
          </ul>
        
      </div>
    </div>
  </section>

</article>


  <section class="next">
    <a class="next__link" href="/2017/02/20/jekyll/" style="background-image: url('/assets/img/jekyll.png');">
      <div class="next__container">
        <span>Read Next</span>
        <h2>Jekyll</h2>
      </div>
    </a>
  </section>


    </main>

    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/rellax/1.0.0/rellax.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/wow/1.1.2/wow.min.js"></script>
<script type="text/javascript" src="/assets/js/app.js"></script>


  </body>

</html>
